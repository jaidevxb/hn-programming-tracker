name: Daily HN Fetch

on: schedule: - cron: "0 4 * * *"  # runs every day at 9:30 AM IST (04:00 UTC) workflow_dispatch:      # allows manual run

jobs: fetch_and_commit: runs-on: ubuntu-latest

steps:
  - name: Checkout repo
    uses: actions/checkout@v4

  - name: Set up Python
    uses: actions/setup-python@v5
    with:
      python-version: "3.11"

  - name: Install dependencies
    run: |
      python -m pip install --upgrade pip
      pip install -r requirements.txt
      python -m textblob.download_corpora
  - name: Run fetch script
    run: python fetch_hn.py

  - name: Commit and push updated data
    run: |
      git config user.name "github-actions[bot]"
      git config user.email "github-actions[bot]@users.noreply.github.com"
      git add data/hn_data.csv
      git commit -m "Auto update: fetched latest HN data" || echo "No changes to commit"
      git push

